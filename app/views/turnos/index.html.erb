<table>
<p>
 
<%= link_to 'Nuevo Evento', new_turno_path, :id => 'nuevo' %>
  
</p>
 <div id = "create_turno">
  </div>
<script type="text/javascript">
  $(document).ready(function(){
      // page is now ready, initialize the calendar...
      $('#calendar').fullCalendar({
          //editable: true,
          header: {
              left: 'prev,next',
              center: 'title'
              /*right: 'month,agendaWeek,agendaDay'*/
          },
          defaultView: 'agendaWeek',
          height: 600,
          slotMinutes: 30,
          minTime : 8,
          maxTime : 21,
          firstDay : 1,
          allDaySlot : false,
          columnFormat:'ddd d/M',
          titleFormat : "MMM d[ yyyy]{ '&#8212;'[ MMMMM] d yyyy}",
          weekends: false,
          defaultEventMinutes : 30,

          buttonText: {prev: '&nbsp;&#9668;&nbsp;',
		next: '&nbsp;&#9658;&nbsp;',
		prevYear: '&nbsp;&lt;&lt;&nbsp;',
		nextYear: '&nbsp;&gt;&gt;&nbsp;',
                today : 'Hoy'},

          unselectAuto: false,
          weekMode : false,
      
          
          monthNamesShort : ['Enero' , 'Febrero' , 'Marzo' , 'Abril' , 'Mayo' , 'Junio' , 'Julio' ,
                        'Agosto' , 'Septiembre' , 'Octubre' , 'Noviembre' , 'Diciembre' ],

          dayNamesShort : ['Domingo', 'Lunes', 'Martes', 'Miercoles', 'Jueves', 'Viernes', 'Sabado'],
          
          loading: function(bool){
              if (bool)
                  $('#loading').show();
              else
                  $('#loading').hide();
          },
          
          events:[
            <% for turno in Turno.all -%>
              {
                id : 'turno: <%= turno.id.to_s %>',
                title  : 'Profesional: <%= turno.profesional.nombre %>',              
                start  : 'Desde: <%= turno.fecha_hora.to_s %>',
                end : 'Hasta: <%= turno.fecha_hora.to_s %>',
                allDay : false
                
              },
            <% end %>

              ],
               
           /* [
        {
            title  : 'event1',
            start  : '2011-03-10',
            allDay : false 
        },
        {
            title  : 'event2',
            start  : '2011-03-09',
            allDay : false
        },
        {
            title  : 'event3',
            start  : '2011-03-08',
            allDay : false // will make the time show
        }
    ],*/

          timeFormat: 'h:mm t{ - h:mm t} ',
          
          dragOpacity: "0.5",



          eventDrop: function(event, dayDelta, minuteDelta, allDay, revertFunc){
              //if (confirm("Are you sure about this change?")) {
                  moveEvent(event, dayDelta, minuteDelta, allDay);
              //}
              //else {
              //    revertFunc();
              //}
          },

          eventResize: function(event, dayDelta, minuteDelta, revertFunc){
              //if (confirm("Are you sure about this change?")) {
                  resizeEvent(event, dayDelta, minuteDelta);
              //}
              //else {
              //    revertFunc();
              //}
          },

          eventClick: function(event, jsEvent, view){
            if (confirm("esta seguro?"),event.destroy) {
            window.open(event.destroy);
            return false;
        }
                   showEventDetails(event);
          }




      });
         $('#nuevo').fancybox(
        {
      'hideOnContentClick': false,
      'titleShow': false

        });


  });
</script>
<div>
  <div id='calendar'>
  </div>
</div>

<div id = "desc_dialog" style ="display:none;">
  <div id = "event_desc">
  </div>
  <br/>
  <br/>
  <div id = "event_actions">
    <span id = "edit_event"></span>

    <span id = "delete_event"></span>
  </div>
</div>
<div id = "create_event_dialog" style ="display:none;">
 
</div>

</table>
